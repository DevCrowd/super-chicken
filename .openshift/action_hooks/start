#!/bin/bash

cd $OPENSHIFT_REPO_DIR

export GRADLE_USER_HOME=$OPENSHIFT_DATA_DIR/gradle
export GRADLE_HOME=$OPENSHIFT_DATA_DIR/gradle-2.6
export PATH=$GRADLE_HOME/bin:$PATH

export JAVA_HOME="$OPENSHIFT_DATA_DIR/jdk1.8.0_05"
export PATH=$OPENSHIFT_DATA_DIR/jdk1.8.0_05/bin:$PATH

gradle update

sed -i 's/OPENSHIFT_DIY_IP/'"$OPENSHIFT_APP_DNS"'/' env.yml
sed -i 's/OPENSHIFT_DIY_PORT/'"$OPENSHIFT_DIY_PORT"'/' env.yml

sed -i 's/OPENSHIFT_POSTGRESQL_DB_USERNAME/'"$OPENSHIFT_POSTGRESQL_DB_USERNAME"'/' env.yml
sed -i 's/OPENSHIFT_POSTGRESQL_DB_PASSWORD/'"$OPENSHIFT_POSTGRESQL_DB_PASSWORD"'/' env.yml
sed -i 's/OPENSHIFT_POSTGRESQL_DB_URL/'"$OPENSHIFT_POSTGRESQL_DB_HOST"'/' env.yml

java -jar build/libs/super-chicken-all.jar server env.yml 
